{"version":3,"file":"wishlist.js","sources":["../src/wishlist.js"],"sourcesContent":["//Логіка сторінки Wishlist\n\nimport { refs } from './js/refs';\nimport * as storage from './js/storage';\nimport * as api from './js/products-api';\nimport {\n  hideNotFound,\n  showNotFound,\n  openProductModal,\n  setWishlistChangeHandler,\n} from './js/handlers';\nimport {\n  renderProducts,\n  renderModalProduct,\n  updateNavCount,\n} from './js/render-function';\nimport { openModal } from './js/modal';\nimport { toastInfo, toggleTheme, toastError } from './js/helpers';\n\nlet pageProducts = [];\n\nasync function initWishlistPage() {\n  updateNavCount();\n  const saved = storage.getTheme();\n  toggleTheme(saved);\n  const ids = storage.getWishlist();\n  if (!ids || ids.length === 0) {\n    if (refs.notFound) refs.notFound.classList.add('not-found--visible');\n    refs.productsList.innerHTML = '';\n    return;\n  }\n\n  try {\n    refs.notFound?.classList.remove('not-found--visible');\n    const promises = ids.map(id => api.getProductById(id));\n    const products = await Promise.all(promises);\n    pageProducts = products;\n    renderProducts(products);\n  } catch (err) {\n    console.error(err);\n    toastInfo('Failed to load wishlist products');\n  }\n}\n\nfunction searchInPageProducts(query) {\n  const q = query.toLowerCase();\n\n  return pageProducts.filter(product => {\n    const titleMatch = product.title?.toLowerCase().includes(q);\n    const categoryMatch = product.category?.toLowerCase().includes(q);\n    const tagsMatch = product.tags?.some(tag => tag.toLowerCase().includes(q));\n\n    return titleMatch || categoryMatch || tagsMatch;\n  });\n}\n\nexport function searchSubmitHandlerLocal(e) {\n  e.preventDefault();\n\n  const query = refs.searchInput.value.trim();\n\n  if (!query) {\n    toastError('Please, enter text');\n    return;\n  }\n\n  refs.searchClearBtn.classList.remove('hidden');\n\n  const filtered = searchInPageProducts(query);\n\n  refs.productsList.innerHTML = '';\n\n  if (filtered.length === 0) {\n    showNotFound();\n    return;\n  }\n\n  hideNotFound();\n  renderProducts(filtered);\n}\nexport function searchClearHandlerLocal() {\n  refs.searchInput.value = '';\n  refs.searchClearBtn.classList.add('hidden');\n\n  hideNotFound();\n  refs.productsList.innerHTML = '';\n  renderProducts(pageProducts);\n}\n\nsetWishlistChangeHandler(() => {\n  initWishlistPage();\n});\n\nrefs.searchForm?.addEventListener('submit', searchSubmitHandlerLocal);\nrefs.searchClearBtn?.addEventListener('click', searchClearHandlerLocal);\n\nrefs.themeToggleBtn?.addEventListener('click', () => {\n  const next = document.body.dataset.theme === 'dark' ? 'light' : 'dark';\n  toggleTheme(next);\n  saveTheme(next);\n});\n\nrefs.productsList?.addEventListener('click', async e => {\n  const li = e.target.closest('.products__item');\n  if (!li) return;\n  const id = li.dataset.id;\n  const product = await api.getProductById(id);\n  openProductModal(Number(li.dataset.id));\n  renderModalProduct(product);\n  openModal();\n  const wishlistBtn = refs.modal.querySelector('.modal-product__btn--wishlist');\n  const cartBtn = refs.modal.querySelector('.modal-product__btn--cart');\n\n  if (wishlistBtn) {\n    wishlistBtn.onclick = () => {\n      if (storage.isInWishlist(id)) {\n        storage.removeFromWishlist(id);\n        wishlistBtn.textContent = 'Add to Wishlist';\n        toastInfo('Removed from wishlist');\n      } else {\n        storage.addToWishlist(id);\n        wishlistBtn.textContent = 'Remove from Wishlist';\n      }\n      updateNavCount();\n      initWishlistPage();\n    };\n  }\n  if (cartBtn) {\n    cartBtn.onclick = () => {\n      if (storage.isInCart(id)) {\n        storage.removeFromCart(id);\n        cartBtn.textContent = 'Add to Cart';\n      } else {\n        storage.addToCart(id);\n        cartBtn.textContent = 'Remove from Cart';\n      }\n      updateNavCount();\n    };\n  }\n});\n\ndocument.addEventListener('DOMContentLoaded', initWishlistPage);\n"],"names":["pageProducts","initWishlistPage","updateNavCount","saved","storage.getTheme","toggleTheme","ids","storage.getWishlist","refs","promises","id","api.getProductById","products","renderProducts","err","toastInfo","searchInPageProducts","query","q","product","titleMatch","categoryMatch","tagsMatch","tag","searchSubmitHandlerLocal","e","toastError","filtered","showNotFound","hideNotFound","searchClearHandlerLocal","setWishlistChangeHandler","next","li","openProductModal","renderModalProduct","openModal","wishlistBtn","cartBtn","storage.isInWishlist","storage.removeFromWishlist","storage.addToWishlist","storage.isInCart","storage.removeFromCart","storage.addToCart"],"mappings":"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"}