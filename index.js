import{s as m,k as _,l as P,m as L,j as l,u as h,r as t,n as g,p as v,g as T,a as A,o as S,q as H,v as w,w as B,I as q,t as f,i as x,b as I,c as R,x as y,d as U,e as W,f as z,y as N,z as p,A as D}from"./assets/helpers-BeIdB43V.js";import"./assets/vendor-BWC8OeqA.js";let n=1,i="All",c="",C=0;async function j(){try{m();const s=await _();P(s),n=1;const{products:e}=await L();l(e),await d({reset:!0}),h(),t.searchClearBtn&&t.searchClearBtn.classList.add("hidden")}catch(s){console.error(s),g("Failed to initialize home page")}finally{v()}}async function d({reset:s=!1}={}){try{s&&(n=1),m();let e;c?e=await w(c,n):i&&i!=="All"?e=await B(i,n):e=await L(n);const o=e.products||[];if(C=e.total??o.length,o.length)t.notFound&&t.notFound.classList.remove("not-found--visible");else{t.productsList.innerHTML="",t.notFound&&t.notFound.classList.add("not-found--visible"),t.loadMoreBtn&&t.loadMoreBtn.classList.add("hidden");return}const a=!s&&n>1;l(o,{append:a}),(n-1)*q+o.length>=C?(t.loadMoreBtn&&t.loadMoreBtn.classList.add("hidden"),f("No more products to load")):t.loadMoreBtn&&t.loadMoreBtn.classList.remove("hidden")}catch(e){console.error(e),g("Failed to load products")}finally{v()}}function G(s){const e=s.target.closest(".categories__btn");if(!e)return;t.searchInput.value="";const o=e.textContent.trim();i=o,c="",n=1,t.categoriesList.querySelectorAll(".categories__btn").forEach(r=>r.classList.toggle("categories__btn--active",r===e)),d({reset:!0}),o==="All"?O():Q(o)}async function O(){try{const{products:s}=await L(n);M(s),t.productsList.innerHTML="",l(s)}catch(s){console.error(s)}}async function Q(s){try{const{products:e}=await B(s,n);M(e),t.productsList.innerHTML="",l(e)}catch(e){console.error(e)}}function M(s){!s||s.length===0?t.notFound.classList.add("not-found--visible"):t.notFound.classList.remove("not-found--visible")}async function Y(s){const e=s.target.closest(".products__item");if(!e)return;const o=e.dataset.id;if(o)try{m();const a=await T(o);A(a),S(),J(a.id)}catch(a){console.error(a),g("Failed to load product details")}finally{v()}}function J(s){const e=t.modal.querySelector(".modal-product__wishlist-btn"),o=t.modal.querySelector(".modal-product__cart-btn"),a=t.modal.querySelector(".modal-product__buy-btn");e&&(e.onclick=()=>{x(s)?(I(s),e.textContent="Add to Wishlist",f("Removed from wishlist")):(R(s),e.textContent="Remove from Wishlist",y("Added to wishlist")),h()}),o&&(o.onclick=()=>{U(s)?(W(s),o.textContent="Add to Cart",f("Removed from cart")):(z(s),o.textContent="Remove from Cart",y("Added to cart")),h()}),a&&(a.onclick=()=>{window.iziToast&&iziToast.success({title:"Success",message:"Purchase complete"})})}function K(){n+=1,d({reset:!1})}async function V(s){s.preventDefault();const e=t.searchInput.value.trim();if(e){t.searchClearBtn.classList.remove("hidden"),H(),c=e,n=1;try{const{products:o}=await w(e,n);t.productsList.innerHTML="";const a=e.toLowerCase(),r=o.filter(u=>{const b=u.title.toLowerCase().includes(a),F=u.category.toLowerCase().includes(a),k=u.tags?.some(E=>E.toLowerCase().includes(a));return b||F||k});if(r.length===0){X();return}Z(),l(r)}catch(o){console.log(o)}}}function X(){t.notFound.classList.add("not-found--visible")}function Z(){t.notFound.classList.remove("not-found--visible")}async function $(){t.searchInput.addEventListener("input",()=>{t.searchInput.value.trim()?t.searchClearBtn.classList.remove("hidden"):t.searchClearBtn.classList.add("hidden")}),t.searchClearBtn.addEventListener("click",()=>{t.searchInput.value="",t.searchClearBtn.classList.add("hidden"),i="All",c="",n=1,d({reset:!0})})}function tt(){t.scrollUpBtn&&(window.addEventListener("scroll",()=>{window.scrollY>300?t.scrollUpBtn.classList.remove("hidden"):t.scrollUpBtn.classList.add("hidden")}),t.scrollUpBtn.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"})))}document.addEventListener("DOMContentLoaded",()=>{const s=N();p(s),j(),t.categoriesList?.addEventListener("click",G),t.productsList?.addEventListener("click",Y),t.loadMoreBtn?.addEventListener("click",K),t.searchForm?.addEventListener("submit",V),t.searchClearBtn?.addEventListener("click",$),t.themeToggleBtn?.addEventListener("click",()=>{const e=document.body.dataset.theme==="dark"?"light":"dark";p(e),D(e)}),tt()});
//# sourceMappingURL=index.js.map
