import{s as l,m as P,n as _,u as m,r as t,p as v,q as d,g as k,a as A,o as T,v as S,w as H,l as u,x as q,y as C,z as B,I as x,c as L,i as I,b as R,d as U,A as g,e as W,f as z,h as N,j as D,t as p,B as j}from"./assets/helpers-D2s_2jWB.js";import"./assets/vendor-Vjjz0Re7.js";let n=1,i="All",c="",y=0;async function G(){try{l();const s=await P();_(s),n=1,await h({reset:!0}),m(),t.searchClearBtn&&t.searchClearBtn.classList.add("hidden")}catch(s){console.error(s),v("Failed to initialize home page")}finally{d()}}async function h({reset:s=!1}={}){try{s&&(n=1),l();let e;c?e=await q(c,n):i&&i!=="All"?e=await C(i,n):e=await B(n);const o=e.products||[];if(y=e.total??o.length,o.length)t.notFound&&t.notFound.classList.remove("not-found--visible");else{t.productsList.innerHTML="",t.notFound&&t.notFound.classList.add("not-found--visible"),t.loadMoreBtn&&t.loadMoreBtn.classList.add("is-hidden");return}const a=!s&&n>1;u(o,{append:a}),(n-1)*x+o.length>=y?(t.loadMoreBtn&&t.loadMoreBtn.classList.add("is-hidden"),L("No more products to load")):t.loadMoreBtn&&t.loadMoreBtn.classList.remove("is-hidden")}catch(e){console.error(e),v("Failed to load products")}finally{d()}}function O(s){const e=s.target.closest(".categories__btn");if(!e)return;t.searchInput.value="";const o=e.textContent.trim();i=o,c="",n=1,t.categoriesList.querySelectorAll(".categories__btn").forEach(r=>r.classList.toggle("categories__btn--active",r===e)),h({reset:!0}),o==="All"?Q():Y(o)}async function Q(){try{const{products:s}=await B(n);w(s),t.productsList.innerHTML="",u(s)}catch(s){console.error(s)}}async function Y(s){try{const{products:e}=await C(s,n);w(e),t.productsList.innerHTML="",u(e)}catch(e){console.error(e)}}function w(s){!s||s.length===0?t.notFound.classList.add("not-found--visible"):t.notFound.classList.remove("not-found--visible")}async function J(s){const e=s.target.closest(".products__item");if(!e)return;const o=e.dataset.id;if(o)try{l();const a=await k(o);A(a),T(),K(a.id)}catch(a){console.error(a),v("Failed to load product details")}finally{d()}}function K(s){const e=t.modal.querySelector(".modal-product__wishlist-btn"),o=t.modal.querySelector(".modal-product__cart-btn"),a=t.modal.querySelector(".modal-product__buy-btn");e&&(e.onclick=()=>{I(s)?(R(s),e.textContent="Add to Wishlist",L("Removed from wishlist")):(U(s),e.textContent="Remove from Wishlist",g("Added to wishlist")),m()}),o&&(o.onclick=()=>{W(s)?(z(s),o.textContent="Add to Cart",L("Removed from cart")):(N(s),o.textContent="Remove from Cart",g("Added to cart")),m()}),a&&(a.onclick=()=>{window.iziToast&&iziToast.success({title:"Success",message:"Purchase complete"})})}function V(){n+=1,h({reset:!1})}async function X(s){s.preventDefault();const e=t.searchInput.value.trim();if(e){t.searchClearBtn.classList.remove("hidden"),S(),c=e,n=1;try{l();const{products:o}=await H(e,n);t.productsList.innerHTML="";const a=e.toLowerCase(),r=o.filter(f=>{const b=f.title.toLowerCase().includes(a),M=f.category.toLowerCase().includes(a),F=f.tags?.some(E=>E.toLowerCase().includes(a));return b||M||F});if(r.length===0){Z();return}$(),u(r),d()}catch(o){console.log(o)}}}function Z(){t.notFound.classList.add("not-found--visible")}function $(){t.notFound.classList.remove("not-found--visible")}async function tt(){t.searchInput.addEventListener("input",()=>{t.searchInput.value.trim()?t.searchClearBtn.classList.remove("hidden"):t.searchClearBtn.classList.add("hidden")}),t.searchClearBtn.addEventListener("click",()=>{t.searchInput.value="",t.searchClearBtn.classList.add("hidden"),i="All",c="",n=1,h({reset:!0})})}function et(){t.scrollUpBtn&&(window.addEventListener("scroll",()=>{window.scrollY>300?t.scrollUpBtn.classList.add("scroll-top-btn--visible"):t.scrollUpBtn.classList.remove("scroll-top-btn--visible")}),t.scrollUpBtn.addEventListener("click",()=>window.scrollTo({top:0,behavior:"smooth"})))}document.addEventListener("DOMContentLoaded",()=>{const s=D();p(s),G(),t.categoriesList?.addEventListener("click",O),t.productsList?.addEventListener("click",J),t.loadMoreBtn?.addEventListener("click",V),t.searchForm?.addEventListener("submit",X),t.searchClearBtn?.addEventListener("click",tt),t.themeToggleBtn?.addEventListener("click",()=>{const e=document.body.dataset.theme==="dark"?"light":"dark";p(e),j(e)}),et()});
//# sourceMappingURL=index.js.map
